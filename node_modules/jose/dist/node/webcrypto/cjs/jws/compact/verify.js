"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const verify_js_1 = require("../flattened/verify.js");
const errors_js_1 = require("../../util/errors.js");
async function compactVerify(jws, key, options) {
    if (typeof jws !== 'string') {
        throw new errors_js_1.JWSInvalid('Compact JWS must be a string');
    }
    const { 0: protectedHeader, 1: payload, 2: signature, length } = jws.split('.');
    if (length !== 3) {
        throw new errors_js_1.JWSInvalid('Invalid Compact JWS');
    }
    const verified = await verify_js_1.default({ payload, protected: protectedHeader, signature }, key, options);
    return { payload: verified.payload, protectedHeader: verified.protectedHeader };
}
exports.default = compactVerify;
